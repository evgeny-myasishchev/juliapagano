#!/usr/bin/env node

'use strict';

//Load initial data into mongo database

const co = require('co');
const initialData = require('../data/initial-data');
const Mongo = require('../app/lib/Mongo');
const logger = require('../app/logging').getLogger('INITIAL-DATA');

const db = new Mongo();

co(function * () {
  yield db.connect();

  logger.info(`Writting pages: ${initialData.pages.length}`);
  const pages = db.collection('pages');
  yield pages.insertMany(initialData.pages);
  logger.info('Initial data loaded into mongo');
})
.then(() => db.close())
.catch((err) => {
  logger.error(`Failed to load initial data`);
  logger.info(err.stack);
  return db.close();
});
